<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>REPL · KJ.jl</title><meta name="title" content="REPL · KJ.jl"/><meta property="og:title" content="REPL · KJ.jl"/><meta property="twitter:title" content="REPL · KJ.jl"/><meta name="description" content="Documentation for KJ.jl."/><meta property="og:description" content="Documentation for KJ.jl."/><meta property="twitter:description" content="Documentation for KJ.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="KJ.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">KJ.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tui/">TUI</a></li><li class="is-active"><a class="tocitem" href>REPL</a><ul class="internal"><li><a class="tocitem" href="#Loading-Data"><span>Loading Data</span></a></li><li><a class="tocitem" href="#View-a-summary-of-the-loaded-data"><span>View a summary of the loaded data</span></a></li><li><a class="tocitem" href="#Defining-Analysis-Methods"><span>Defining Analysis Methods</span></a></li><li><a class="tocitem" href="#Processing-Data"><span>Processing Data</span></a></li><li><a class="tocitem" href="#Visualisation"><span>Visualisation</span></a></li><li><a class="tocitem" href="#Outlier-Detection"><span>Outlier Detection</span></a></li><li><a class="tocitem" href="#Data-Analysis-and-Statistics"><span>Data Analysis and Statistics</span></a></li><li><a class="tocitem" href="#Exporting-to-IsoplotR"><span>Exporting to IsoplotR</span></a></li></ul></li><li><a class="tocitem" href="../developers/">Developers</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>REPL</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>REPL</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/pvermees/KJ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/pvermees/KJ.jl/blob/main/docs/src/repl.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples-(REPL)"><a class="docs-heading-anchor" href="#Examples-(REPL)">Examples (REPL)</a><a id="Examples-(REPL)-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-(REPL)" title="Permalink"></a></h1><p>Advanced users can interact directly with KJ via the Julia REPL (&quot;read-eval-print loop&quot;) for maximum flexibility and control over data processing pipelines.</p><h2 id="Loading-Data"><a class="docs-heading-anchor" href="#Loading-Data">Loading Data</a><a id="Loading-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-Data" title="Permalink"></a></h2><p>Some labs prefer to store each analysis in a separate data file. Others prefer to put all analyses into a single file, which is parsed into chunks according to a separately provided laser log file. A third option is to divide each analysis into several files corresponding to background, signal and washout, respectively. Sample names are either stored in the data files, or have to be derived from the file names. <code>KJ</code> accommodates all these methods of operation. They are illustrated here with example data files that are packaged with the software.</p><p>Load LA-ICP-MS data from a directory of <code>.csv</code> files from an Agilent instrument:</p><pre><code class="language-julia hljs">using KJ
LuHf_run = load(&quot;data/Lu-Hf&quot;; format=&quot;Agilent&quot;)
ReOs_run = load(&quot;data/Re-Os&quot;; format=&quot;Agilent&quot;)
KCa_run = load(&quot;data/K-Ca&quot;; format=&quot;Agilent&quot;)</code></pre><p>Load data in a ThermoFisher format:</p><pre><code class="language-julia hljs">iCap_run = load(&quot;data/iCap&quot;; format=&quot;ThermoFisher&quot;)</code></pre><p>Load UPb data with sample names extracted from file names:</p><pre><code class="language-julia hljs">UPb_run = load(&quot;data/U-Pb&quot;; format=&quot;Agilent&quot;, head2name=false)</code></pre><p>Load data from a Neptune MC-ICP-MS with background, signal and washout split in different files:</p><pre><code class="language-julia hljs">MC_run = load(&quot;data/FIN2&quot;; format=&quot;FIN2&quot;, nblocks=3)</code></pre><p>Load data from one massive <code>.csv</code> file with timestamps provided in a separate laser log file:</p><pre><code class="language-julia hljs">map_run = load(&quot;data/timestamp/NHM_data.csv&quot;,
               &quot;data/timestamp/NHM_timestamps.csv&quot;;
               format=&quot;Agilent&quot;)</code></pre><h2 id="View-a-summary-of-the-loaded-data"><a class="docs-heading-anchor" href="#View-a-summary-of-the-loaded-data">View a summary of the loaded data</a><a id="View-a-summary-of-the-loaded-data-1"></a><a class="docs-heading-anchor-permalink" href="#View-a-summary-of-the-loaded-data" title="Permalink"></a></h2><p>Show all the samples in a run:</p><pre><code class="language-julia hljs">summarise(UPb_run)</code></pre><h2 id="Defining-Analysis-Methods"><a class="docs-heading-anchor" href="#Defining-Analysis-Methods">Defining Analysis Methods</a><a id="Defining-Analysis-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-Analysis-Methods" title="Permalink"></a></h2><h3 id="Simple-Geochronology"><a class="docs-heading-anchor" href="#Simple-Geochronology">Simple Geochronology</a><a id="Simple-Geochronology-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-Geochronology" title="Permalink"></a></h3><p><code>KJ</code> implements two types of methods <code>Gmethod</code> for geochronology, and <code>Cmethod</code> for chemical concentration measurements. The simplest definition of a <code>Gmethod</code> requires just the name of the geochronometer of interest:</p><pre><code class="language-julia hljs">UPb_method = Gmethod(name=&quot;U-Pb&quot;)</code></pre><p>Additional arguments can be used to specify the prefixes of reference materials as <code>groups</code>. Prefixes that are missing from this Dict will be treated as samples. For example, suppose that a run uses two primary reference materials: Plesovice and 91500; which are labelled as <code>STDCZ</code> and <code>91500</code>, respectively:</p><pre><code class="language-julia hljs">UPb_method = Gmethod(name=&quot;U-Pb&quot;, 
                     groups=Dict(&quot;STDCZ&quot; =&gt; &quot;Plesovice&quot;, &quot;91500&quot; =&gt; &quot;91500&quot;),
                     standards=Set([&quot;STDCZ&quot;,&quot;91500&quot;]))</code></pre><p>The <code>.csv</code> files with raw data contain column headers (&quot;channels&quot;) that correspond to different mass-to-charge ratios in the mass spectrometer. For the U-Pb dataset shown above, it is easy to match these column headers with the geochronologically relevant isotopes (&quot;U238&quot;, &quot;Pb206&quot; and &quot;Pb207&quot;). This is not always the case. In the case of &amp;beta;-chronometry (Lu-Hf, Re-Os, K-Ca, Rb-Sr), the column headers include chemical information that is not so easy for <code>KJ</code> to disentangle. These methods are based on the following age equation:</p><p class="math-container">\[\frac{D}{d} = \left[\frac{D}{d}\right]_0 + \frac{P}{d} \left(e^{\lambda t} - 1\right)\]</p><p>where <code>P</code>, <code>D</code> and <code>d</code> refer to the radioactive &quot;parent&quot;, radiogenic &quot;daughter&quot; and non-radiogenic &quot;sister&quot; isotope. An additional complexity arises because <code>P</code> and <code>d</code> are often measured by proxy, using a different isotope. These complexities are accommodated by providing the <code>Gmethod</code> constructor with <code>Pairing</code>s:</p><pre><code class="language-julia hljs">LuHf_method = Gmethod(name=&quot;Lu-Hf&quot;,
                      groups=Dict(&quot;hogsbo&quot; =&gt; &quot;Hogsbo&quot;, &quot;NIST612p&quot; =&gt; &quot;NIST612&quot;),
                      P=Pairing(ion=&quot;Lu176&quot;, proxy=&quot;Lu175&quot;, channel=&quot;Lu175 -&gt; 175&quot;),
                      D=Pairing(ion=&quot;Hf176&quot;, channel=&quot;Hf176 -&gt; 258&quot;),
                      d=Pairing(ion=&quot;Hf177&quot;, proxy=&quot;Hf178&quot;, channel=&quot;Hf178 -&gt; 260&quot;),
                      standards=Set([&quot;hogsbo&quot;]))</code></pre><h3 id="Advanced-Geochronology"><a class="docs-heading-anchor" href="#Advanced-Geochronology">Advanced Geochronology</a><a id="Advanced-Geochronology-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Geochronology" title="Permalink"></a></h3><p>Add a mass bias correction for &lt;sup&gt;176&lt;/sup&gt;Hf/&lt;sup&gt;178&lt;/sup&gt;Hf based on the known ratio of NIST-612 standard glass, and a correction for the isobaric interference of &lt;sup&gt;176&lt;/sup&gt;Lu on &lt;sup&gt;176&lt;/sup&gt;Hf, measured by proxy using the reaction products of &lt;sup&gt;175&lt;/sup&gt;Lu and the known &lt;sup&gt;176&lt;/sup&gt;Lu/&lt;sup&gt;175&lt;/sup&gt;Lu ratio of the Solar System:</p><pre><code class="language-julia hljs">Calibration!(LuHf_method; standards=Set([&quot;NIST612p&quot;]))
LuHf_method.D.interferences[&quot;Lu176&quot;] = Interference(proxy=&quot;Lu175&quot;, channel=&quot;Lu175 -&gt; 257&quot;)</code></pre><p>A Re-Os example with complex interferences, including:</p><ul><li>an elemental fractionation correction using QMolyHill molybdenite as a primary reference material</li><li>a mass bias correction for &lt;sup&gt;187&lt;/sup&gt;Os/&lt;sup&gt;188&lt;/sup&gt;Os measured in the NiS-3 reference material</li><li>an interference correction of &lt;sup&gt;187&lt;/sup&gt;Re on &lt;sup&gt;187&lt;/sup&gt;Os measured using NIST-610 glass</li><li>a Rare Earth interference of TmO on &lt;sup&gt;185&lt;/sup&gt;Re, using LuO/Lu ratio as a proxy</li></ul><pre><code class="language-julia hljs">ReOs_method = Gmethod(name=&quot;Re-Os&quot;,
                      groups=Dict(&quot;Nis3&quot; =&gt; &quot;NiS-3&quot;,
                                  &quot;Nist_massbias&quot; =&gt; &quot;NIST610&quot;,
                                  &quot;Nist_REEint&quot; =&gt; &quot;NIST610&quot;,
                                  &quot;Qmoly&quot; =&gt; &quot;QMolyHill&quot;),
                      P=Pairing(ion=&quot;Re187&quot;, proxy=&quot;Re185&quot;, channel=&quot;Re185 -&gt; 185&quot;),
                      D=Pairing(ion=&quot;Os187&quot;, channel=&quot;Os187 -&gt; 251&quot;),
                      d=Pairing(ion=&quot;Os188&quot;, proxy=&quot;Os189&quot;, channel=&quot;Os189 -&gt; 253&quot;),
                      standards=Set([&quot;Qmoly&quot;]))
Calibration!(ReOs_method;standards=Set([&quot;Nis3&quot;]))
Re_bias = Calibration(num=(ion=&quot;Re187&quot;,channel=&quot;Os187 -&gt; 251&quot;),
                      den=(ion=&quot;Re185&quot;,channel=&quot;Re185 -&gt; 249&quot;),
                      standards=Set([&quot;Nist_massbias&quot;]))
ReOs_method.D.interferences[&quot;Re187&quot;] = Interference(proxy=&quot;Re185&quot;,
                                                    channel=&quot;Re185 -&gt; 249&quot;,
                                                    bias=Re_bias)
ReOs_method.P.interferences[&quot;Tm169 -&gt; 185&quot;] = REEInterference(REE=&quot;Lu175 -&gt; 191&quot;,
                                                              REEO=&quot;Ir191 -&gt; 191&quot;,
                                                              standards=Set([&quot;Nist_REEint&quot;]))</code></pre><h3 id="Concentrations"><a class="docs-heading-anchor" href="#Concentrations">Concentrations</a><a id="Concentrations-1"></a><a class="docs-heading-anchor-permalink" href="#Concentrations" title="Permalink"></a></h3><p>To measure elemental concentration, <code>KJ</code> uses stoichiometric elements as internal references. It then compares all other elements with this internal standard, and with a concentration standard such as NIST glass:</p><pre><code class="language-julia hljs">map_method = Cmethod(map_run;
                     groups=Dict(&quot;NIST612&quot; =&gt; &quot;NIST612&quot;),
                     internal=getInternal(&quot;zircon&quot;,&quot;Si29&quot;))</code></pre><h2 id="Processing-Data"><a class="docs-heading-anchor" href="#Processing-Data">Processing Data</a><a id="Processing-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Processing-Data" title="Permalink"></a></h2><h3 id="Selection-Windows"><a class="docs-heading-anchor" href="#Selection-Windows">Selection Windows</a><a id="Selection-Windows-1"></a><a class="docs-heading-anchor-permalink" href="#Selection-Windows" title="Permalink"></a></h3><p>A typical laser ablation analysis consists of three phases:</p><ol><li>an initial phase in which the laser fires into a shutter whilst the ICP-MS measures the <em>background</em></li><li>opening of the shutter (&quot;time zero&quot;) followed by the measurements of the <em>signal</em></li><li>switching off the laser and <em>washout</em> of the signal from the tubing of the instrument</li></ol><p><code>KJ</code> aims to automatically partition these measurements into these three phases. However, the user can also manually override its decisions. To view the windows for the second sample in the Lu-Hf run:</p><pre><code class="language-julia hljs">sample_index = 2
p = KJ.plot(LuHf_run[sample_index];
            channels=[&quot;Hf176 -&gt; 258&quot;, &quot;Hf178 -&gt; 260&quot;])
display(p)</code></pre><p>Now change the blank window for all the samples from 0 to 22 seconds:</p><pre><code class="language-julia hljs">setBwin!(LuHf_run, [(0,22)]; seconds=true)</code></pre><p>Create a two-part signal window for the selected sample:</p><pre><code class="language-julia hljs">setSwin!(LuHf_run[sample_index], [(70,90), (100,140)])</code></pre><p>Automatically set the background and signal windows for all samples:</p><pre><code class="language-julia hljs">setBwin!(LuHf_run)
setSwin!(LuHf_run)</code></pre><h3 id="Basic-Processing"><a class="docs-heading-anchor" href="#Basic-Processing">Basic Processing</a><a id="Basic-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Processing" title="Permalink"></a></h3><p>Process the entire dataset with a single command. This automatically places samples into the correct groups, applies corrections for background, interferences and mass bias, before parameterising the elemental fractionation.</p><pre><code class="language-julia hljs">UPb_fit = process!(UPb_run, UPb_method)</code></pre><h2 id="Visualisation"><a class="docs-heading-anchor" href="#Visualisation">Visualisation</a><a id="Visualisation-1"></a><a class="docs-heading-anchor-permalink" href="#Visualisation" title="Permalink"></a></h2><h3 id="Basic-Plotting"><a class="docs-heading-anchor" href="#Basic-Plotting">Basic Plotting</a><a id="Basic-Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Plotting" title="Permalink"></a></h3><p>Plot the first sample of the LuHf run with specified channels:</p><pre><code class="language-julia hljs">p = KJ.plot(LuHf_run[1]; channels=[&quot;Hf176 -&gt; 258&quot;, &quot;Hf178 -&gt; 260&quot;])
display(p)</code></pre><p>Take ratios and plot on a log scale:</p><pre><code class="language-julia hljs">p = KJ.plot(LuHf_run[1];
            channels=[&quot;Lu175 -&gt; 175&quot;, &quot;Hf176 -&gt; 258&quot;, &quot;Hf178 -&gt; 260&quot;],
            den=&quot;Hf178 -&gt; 260&quot;,
            transformation=&quot;log&quot;)
display(p)</code></pre><h3 id="Processing-Results"><a class="docs-heading-anchor" href="#Processing-Results">Processing Results</a><a id="Processing-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Processing-Results" title="Permalink"></a></h3><p>The output of <code>process!</code> can be added to the plot for the reference materials. This allows a visual inspection of the goodness-of-fit:</p><pre><code class="language-julia hljs">p = KJ.plot(UPb_run[2], UPb_method; fit=UPb_fit,
            transformation=&quot;log&quot;)
display(p)</code></pre><h3 id="Specialised-Plots"><a class="docs-heading-anchor" href="#Specialised-Plots">Specialised Plots</a><a id="Specialised-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Specialised-Plots" title="Permalink"></a></h3><p>One of the unique features of <code>KJ</code> is its ability to fit <em>internal isochrons</em> based on time resolved atomic abundance estimates. This can be used to correct the non-radiogenic component of individual crystals without the need to assume an isochron intercept. Applying this idea to a laser ablation line across a large garnet:</p><pre><code class="language-julia hljs">lines_run = load(&quot;data/lines&quot;,format=&quot;Agilent&quot;)
lines_method = Gmethod(name=&quot;Lu-Hf&quot;,
                       groups=Dict(&quot;Hog&quot; =&gt; &quot;Hogsbo&quot;),
                       P=Pairing(ion=&quot;Lu176&quot;,proxy=&quot;Lu175&quot;,channel=&quot;Lu175 -&gt; 175&quot;),
                       D=Pairing(ion=&quot;Hf176&quot;,proxy=&quot;Hf176&quot;,channel=&quot;Hf176 -&gt; 258&quot;),
                       d=Pairing(ion=&quot;Hf177&quot;,proxy=&quot;Hf178&quot;,channel=&quot;Hf178 -&gt; 260&quot;),
                       standards=Set([&quot;Hog&quot;]),
                       ndown=0,
                       ndrift=1)
lines_fit = process!(lines_run,lines_method)
p = internoplot(lines_run[7],lines_method,lines_fit)
display(p)</code></pre><p><code>KJ</code> also provides very simple functionality to plot elemental concentration maps:</p><pre><code class="language-julia hljs">map_fit = process!(map_run,map_method)
conc = concentrations(map_run[10],map_method,map_fit)
p = plotMap(conc,&quot;ppm[U] from U238&quot;;
            clims=(0,500),
            colorbar_scale=:identity)
display(p)</code></pre><p>The output of the <code>concentrations(...)</code> function can also be saved to a data frame or output file for more sophisticated plotting in other Julia packages, or in external software:</p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(a)</code></pre><h2 id="Outlier-Detection"><a class="docs-heading-anchor" href="#Outlier-Detection">Outlier Detection</a><a id="Outlier-Detection-1"></a><a class="docs-heading-anchor-permalink" href="#Outlier-Detection" title="Permalink"></a></h2><p>By default, <code>KJ</code> automatically identifies &quot;spikes&quot; in the time resolved data, using a multivariate outlier detection algorithm that fits a multivariate normal distribution to the raw data using the robust minimum covariance determinant (MCD) estimation method. Given this fitted distribution, outliers are flagged by applying &quot;Tukey&#39;s fences&quot; to the Mahalanobis distance. Applying this algorithm to some K-Ca data:</p><pre><code class="language-julia hljs">channels = [&quot;K39 -&gt; 39&quot;, &quot;Ca40 -&gt; 59&quot;, &quot;Ca44 -&gt; 63&quot;]
detect_outliers!(KCa_run; include_samples=true, channels=channels)
p = KJ.plot(KCa_run[1]; channels=channels, transformation=&quot;log&quot;)
display(p)</code></pre><h2 id="Data-Analysis-and-Statistics"><a class="docs-heading-anchor" href="#Data-Analysis-and-Statistics">Data Analysis and Statistics</a><a id="Data-Analysis-and-Statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Analysis-and-Statistics" title="Permalink"></a></h2><h3 id="Estimate-atomic-abundances"><a class="docs-heading-anchor" href="#Estimate-atomic-abundances">Estimate atomic abundances</a><a id="Estimate-atomic-abundances-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-atomic-abundances" title="Permalink"></a></h3><p><code>KJ</code> converts the time resolved signals (which can be recorded in V, A or Hz) to time resolved estimates of atomic abundances in arbitrary units. This low level output can be extracted from <code>KJ</code> and processed in Julia or other software.</p><pre><code class="language-julia hljs">using Plots
a = atomic(LuHf_run[1],LuHf_method,LuHf_fit)
p = Plots.scatter(a.D,a.d,label=&quot;&quot;,xlabel=&quot;P&quot;,ylabel=&quot;d&quot;)
display(p)</code></pre><h3 id="Extract-Isotopic-Ratios"><a class="docs-heading-anchor" href="#Extract-Isotopic-Ratios">Extract Isotopic Ratios</a><a id="Extract-Isotopic-Ratios-1"></a><a class="docs-heading-anchor-permalink" href="#Extract-Isotopic-Ratios" title="Permalink"></a></h3><p>Compute mean isotopic ratios for all samples:</p><pre><code class="language-julia hljs">using CSV
LuHf_fit = process!(LuHf_run, LuHf_method)
LuHf_ratios = averat(LuHf_run, LuHf_method, LuHf_fit)
selection = prefix2subset(LuHf_ratios, &quot;hogsbo&quot;)
CSV.write(&quot;output/hogsbo.csv&quot;,selection)</code></pre><h3 id="Internal-Isochron-Calculation"><a class="docs-heading-anchor" href="#Internal-Isochron-Calculation">Internal Isochron Calculation</a><a id="Internal-Isochron-Calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-Isochron-Calculation" title="Permalink"></a></h3><p>Save the ages and intercepts of all internal isochrons in <code>LuHf_run</code> to a <code>.csv</code> file:</p><pre><code class="language-julia hljs">isochron = internochron(LuHf_run, LuHf_method, LuHf_fit)
CSV.write(&quot;output/isochron.csv&quot;, isochron)</code></pre><h2 id="Exporting-to-IsoplotR"><a class="docs-heading-anchor" href="#Exporting-to-IsoplotR">Exporting to IsoplotR</a><a id="Exporting-to-IsoplotR-1"></a><a class="docs-heading-anchor-permalink" href="#Exporting-to-IsoplotR" title="Permalink"></a></h2><p>Export the U-Pb results for use in <a href="https://isoplotr.es.ucl.ac.uk">IsoplotR</a>:</p><pre><code class="language-julia hljs">export2IsoplotR(UPb_run, UPb_method, UPb_fit; fname=&quot;output/U-Pb.json&quot;)</code></pre><p>Select specific samples with a prefix filter:</p><pre><code class="language-julia hljs">export2IsoplotR(UPb_run, UPb_method, UPb_fit;
                prefix=&quot;GJ1&quot;,
                fname=&quot;output/GJ1.json&quot;)</code></pre><p>Export pre-computed ratios:</p><pre><code class="language-julia hljs">export2IsoplotR(LuHf_ratios, LuHf_method; fname=&quot;output/Lu-Hf.json&quot;)</code></pre><p>For detailed function documentation, see the <a href="../api/">API reference</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tui/">« TUI</a><a class="docs-footer-nextpage" href="../developers/">Developers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Monday 23 February 2026 10:10">Monday 23 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
