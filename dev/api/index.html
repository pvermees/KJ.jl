<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · KJ.jl</title><meta name="title" content="API · KJ.jl"/><meta property="og:title" content="API · KJ.jl"/><meta property="twitter:title" content="API · KJ.jl"/><meta name="description" content="Documentation for KJ.jl."/><meta property="og:description" content="Documentation for KJ.jl."/><meta property="twitter:description" content="Documentation for KJ.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="KJ.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">KJ.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../repl/">REPL</a></li><li><a class="tocitem" href="../tui/">TUI</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/pvermees/KJ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/pvermees/KJ.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="KJ.KJ"><a class="docstring-binding" href="#KJ.KJ"><code>KJ.KJ</code></a> — <span class="docstring-category">Module</span></summary><section><div><p>KJ</p><p>A Julia package to process LA-ICP-MS data</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/KJ.jl#L1-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.AbstractAnchor"><a class="docstring-binding" href="#KJ.AbstractAnchor"><code>KJ.AbstractAnchor</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractAnchor</code></pre><p>Abstract base type for anchor point definitions in isotope ratio space.</p><p>Anchor points represent known isotopic compositions of reference materials used for fractionation correction. Subtypes include <code>IsochronAnchor</code>, <code>PointAnchor</code>, and <code>BiasAnchor</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L144-L152">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.AbstractBias"><a class="docstring-binding" href="#KJ.AbstractBias"><code>KJ.AbstractBias</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractBias</code></pre><p>Abstract base type for mass bias correction parameters.</p><p>Subtypes include <code>Bias</code> for standard isotope ratio bias and <code>REEBias</code> for rare earth element oxide bias corrections.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L235-L242">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.AbstractInterference"><a class="docstring-binding" href="#KJ.AbstractInterference"><code>KJ.AbstractInterference</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractInterference</code></pre><p>Abstract base type for interference correction specifications.</p><p>Subtypes include <code>Interference</code> for general isobaric interferences and <code>REEInterference</code> for rare earth element oxide interferences.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L80-L87">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.AbstractRefmat"><a class="docstring-binding" href="#KJ.AbstractRefmat"><code>KJ.AbstractRefmat</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractRefmat</code></pre><p>Abstract base type for reference material definitions.</p><p>Subtypes include <code>IsochronRefmat</code>, <code>PointRefmat</code>, and <code>BiasRefmat</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L31-L37">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Bias"><a class="docstring-binding" href="#KJ.Bias"><code>KJ.Bias</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Bias &lt;: AbstractBias</code></pre><p>Mass bias correction parameters for isotope ratios.</p><p><strong>Fields</strong></p><ul><li><code>mass_num</code>: Atomic mass of numerator isotope</li><li><code>mass_den</code>: Atomic mass of denominator isotope</li><li><code>par</code>: Vector of polynomial coefficients for bias correction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L246-L255">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Calibration"><a class="docstring-binding" href="#KJ.Calibration"><code>KJ.Calibration</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Calibration</code></pre><p>Calibration settings for mass bias correction.</p><p><strong>Fields</strong></p><ul><li><code>num</code>: Named tuple with numerator isotope (ion, channel)</li><li><code>den</code>: Named tuple with denominator isotope (ion, channel)</li><li><code>standards</code>: Set of reference material names used for calibration</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L63-L72">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Cfit"><a class="docstring-binding" href="#KJ.Cfit"><code>KJ.Cfit</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Cfit &lt;: KJfit</code></pre><p>Fitted parameters for concentration methods.</p><p><strong>Fields</strong></p><ul><li><code>blank</code>: DataFrame of polynomial coefficients for blank corrections</li><li><code>par</code>: DataFrame of sensitivity factors for each element</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L309-L317">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Cmethod"><a class="docstring-binding" href="#KJ.Cmethod"><code>KJ.Cmethod</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Cmethod &lt;: KJmethod</code></pre><p>Concentration method definition for quantitative element analysis.</p><p><strong>Fields</strong></p><ul><li><code>elements</code>: Named tuple of elements to quantify</li><li><code>groups</code>: Dictionary mapping group names to reference material names</li><li><code>internal</code>: Tuple specifying internal standard (channel, concentration)</li><li><code>nblank</code>: Polynomial order for blank fitting</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L216-L226">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Gfit"><a class="docstring-binding" href="#KJ.Gfit"><code>KJ.Gfit</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Gfit &lt;: KJfit</code></pre><p>Fitted parameters for geochronology methods.</p><p><strong>Fields</strong></p><ul><li><code>blank</code>: DataFrame of polynomial coefficients for blank corrections</li><li><code>drift</code>: Vector of drift correction parameters</li><li><code>down</code>: Vector of downhole fractionation parameters</li><li><code>adrift</code>: Vector of analog mode drift parameters</li><li><code>covmat</code>: Covariance matrix of fitted parameters</li><li><code>bias</code>: Dictionary of mass bias corrections by element</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L286-L298">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Gmethod"><a class="docstring-binding" href="#KJ.Gmethod"><code>KJ.Gmethod</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Gmethod &lt;: KJmethod</code></pre><p>Geochronology method definition for parent-daughter isotope dating systems.</p><p><strong>Fields</strong></p><ul><li><code>name</code>: Method name (e.g., &quot;U-Pb&quot;, &quot;Rb-Sr&quot;, &quot;Lu-Hf&quot;, &quot;K-Ca&quot;, &quot;Re-Os&quot;)</li><li><code>groups</code>: Dictionary mapping group names to reference material names</li><li><code>P</code>, <code>D</code>, <code>d</code>: Pairing definitions for parent, daughter, and normalizing isotopes</li><li><code>bias</code>: Calibration settings for mass bias correction</li><li><code>standards</code>: Set of standard names used for fractionation correction</li><li><code>nblank</code>: Polynomial order for blank fitting (default: 2)</li><li><code>ndrift</code>: Polynomial order for drift correction (default: 2)</li><li><code>ndown</code>: Polynomial order for downhole fractionation (default: 1)</li><li><code>nbias</code>: Polynomial order for bias correction (default: 1)</li><li><code>PAcutoff</code>: Cutoff for analog vs counting mode (default: Inf)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L183-L199">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Interference"><a class="docstring-binding" href="#KJ.Interference"><code>KJ.Interference</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Interference &lt;: AbstractInterference</code></pre><p>Interference correction specification for isobaric interferences.</p><p><strong>Fields</strong></p><ul><li><code>proxy</code>: Proxy isotope used to estimate the interference</li><li><code>channel</code>: Channel being corrected for interference</li><li><code>bias</code>: Calibration object for any associated bias correction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L91-L100">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.KJfit"><a class="docstring-binding" href="#KJ.KJfit"><code>KJ.KJfit</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">KJfit</code></pre><p>Abstract base type for fitted LA-ICP-MS correction parameters.</p><p>Subtypes include:</p><ul><li><code>Gfit</code>: Fitted parameters for geochronology methods</li><li><code>Cfit</code>: Fitted parameters for concentration methods</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L274-L282">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.KJmethod"><a class="docstring-binding" href="#KJ.KJmethod"><code>KJ.KJmethod</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">KJmethod</code></pre><p>Abstract base type for LA-ICP-MS data reduction methods.</p><p>Subtypes include:</p><ul><li><code>Gmethod</code>: Geochronology methods for parent-daughter isotope dating</li><li><code>Cmethod</code>: Concentration methods for quantitative element analysis</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L171-L179">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Pairing"><a class="docstring-binding" href="#KJ.Pairing"><code>KJ.Pairing</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Pairing</code></pre><p>Isotope pairing specification linking ions, proxies, and channels.</p><p><strong>Fields</strong></p><ul><li><code>ion</code>: Isotope notation (e.g., &quot;Pb206&quot;)</li><li><code>proxy</code>: Proxy isotope used for calculations (defaults to ion)</li><li><code>channel</code>: Measured channel name (defaults to proxy)</li><li><code>interferences</code>: Dictionary of interference corrections to apply</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L125-L135">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.REEBias"><a class="docstring-binding" href="#KJ.REEBias"><code>KJ.REEBias</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">REEBias &lt;: AbstractBias</code></pre><p>Rare Earth Element oxide bias correction parameters.</p><p><strong>Fields</strong></p><ul><li><code>par</code>: Vector of polynomial coefficients for bias correction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L262-L269">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.REEInterference"><a class="docstring-binding" href="#KJ.REEInterference"><code>KJ.REEInterference</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">REEInterference &lt;: AbstractInterference</code></pre><p>Rare Earth Element (REE) oxide interference correction specification.</p><p><strong>Fields</strong></p><ul><li><code>REE</code>: REE element channel</li><li><code>REEO</code>: REE oxide channel</li><li><code>standards</code>: Set of reference materials used for calibration</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L108-L117">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Sample"><a class="docstring-binding" href="#KJ.Sample"><code>KJ.Sample</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Sample</code></pre><p>Represents a single LA-ICP-MS measurement.</p><p><strong>Fields</strong></p><ul><li><code>sname</code>: Sample name</li><li><code>datetime</code>: Acquisition date and time</li><li><code>dat</code>: DataFrame containing time-series measurements</li><li><code>t0</code>: Time of ablation onset (seconds)</li><li><code>bwin</code>: Vector of blank window tuples (start<em>index, end</em>index)</li><li><code>swin</code>: Vector of signal window tuples (start<em>index, end</em>index)</li><li><code>group</code>: Group label (e.g., &quot;sample&quot;, standard name)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/types.jl#L1-L14">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.Calibration!-Tuple{Gmethod}"><a class="docstring-binding" href="#KJ.Calibration!-Tuple{Gmethod}"><code>KJ.Calibration!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">Calibration!(method::Gmethod; standards=Set{String}())</code></pre><p>Initialize the calibration (bias correction) for a geochronology method.</p><p>This sets up the bias calibration structure using the sister/daughter isotope ratio, which will later be fitted using reference materials.</p><p><strong>Arguments</strong></p><ul><li><code>method</code>: Geochronology method to set up calibration for</li><li><code>standards</code>: Set of standard names to use for calibration (default: empty set)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/Calibration.jl#L1-L12">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.KJtree!-Tuple{AbstractDict}"><a class="docstring-binding" href="#KJ.KJtree!-Tuple{AbstractDict}"><code>KJ.KJtree!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">KJtree!(tree::AbstractDict)</code></pre><p>Set the KJ menu tree for the text user interface.</p><p><strong>Arguments</strong></p><ul><li><code>tree</code>: Dictionary defining the TUI menu structure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/TUI.jl#L121-L128">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.KJtree-Tuple{}"><a class="docstring-binding" href="#KJ.KJtree-Tuple{}"><code>KJ.KJtree</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">KJtree()</code></pre><p>Get the current KJ menu tree.</p><p><strong>Returns</strong></p><ul><li>Dictionary containing the TUI menu structure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/TUI.jl#L134-L141">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.SS-Tuple{KJ.IsochronAnchor, AbstractVector, AbstractVector}"><a class="docstring-binding" href="#KJ.SS-Tuple{KJ.IsochronAnchor, AbstractVector, AbstractVector}"><code>KJ.SS</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">SS(a::AbstractAnchor, ft::AbstractVector, hT::AbstractVector; cruncher...)
SS(par::AbstractVector, method::Gmethod, cruncher_groups::AbstractDict; verbose=false)
SS(bias::AbstractBias; cruncher...)</code></pre><p>Calculate the sum of squares objective function for optimization.</p><p>This function computes the weighted sum of squared residuals between measured and predicted values, used for fitting fractionation corrections and bias terms.</p><p><strong>Arguments</strong></p><ul><li><code>a</code>/<code>par</code>: Anchor point or parameter vector</li><li><code>ft</code>, <code>hT</code>: Fractionation factors (for anchor-based calls)</li><li><code>method</code>: Geochronology method (for parameter-based calls)</li><li><code>cruncher</code>/<code>cruncher_groups</code>: Data and covariances</li><li><code>verbose</code>: Print diagnostic information</li></ul><p><strong>Returns</strong></p><ul><li>Sum of squared Mahalanobis distances</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/crunch.jl#L156-L176">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.TUI-Tuple"><a class="docstring-binding" href="#KJ.TUI-Tuple"><code>KJ.TUI</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>KJ(extensions...;logbook::AbstractString=&quot;&quot;,reset=false)</p><p>KJ TUI</p><p><strong>Arguments</strong></p><ul><li><code>extensions...</code>: a comma separated list of KJ extensions</li><li><code>logbook</code>: the file path to a KJ log</li><li><code>reset</code>: hard reset of all inherited settings</li><li><code>debug</code>: whether to print the error stack trace when an error occurs (default: false)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">TUI(logbook=&quot;logs/test.log&quot;)
ctrl = getKJctrl()
samp = ctrl[&quot;run&quot;][1]
p = plot(samp)
display(p)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/TUI.jl#L1-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.atomic-Tuple{Sample, Gmethod, Gfit}"><a class="docstring-binding" href="#KJ.atomic-Tuple{Sample, Gmethod, Gfit}"><code>KJ.atomic</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">atomic(samp::Sample, method::Gmethod, fit::Gfit; add_xy=false)</code></pre><p>Calculate atomic abundances (P, D, d) from measured signals.</p><p>Applies all corrections (blank, interference, bias, fractionation) to convert raw signal intensities to corrected atomic abundances.</p><p><strong>Arguments</strong></p><ul><li><code>samp</code>: Sample to process</li><li><code>method</code>: Geochronology method definition</li><li><code>fit</code>: Fitted correction parameters</li><li><code>add_xy</code>: Include x,y spatial coordinates if available (default: false)</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with fields P (parent), D (daughter), d (sister/normalizing isotope), and optionally x, y coordinates</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/atomic.jl#L1-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.averat-Tuple{Vector{Sample}, Gmethod, Gfit}"><a class="docstring-binding" href="#KJ.averat-Tuple{Vector{Sample}, Gmethod, Gfit}"><code>KJ.averat</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">averat(run::Vector{Sample}, method::Gmethod, fit::Gfit)
averat(samp::Sample, method::Gmethod, fit::Gfit)</code></pre><p>Calculate average ratios for samples using a weighted mean approach.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>/<code>samp</code>: Vector of samples or single sample</li><li><code>method</code>: Geochronology method definition</li><li><code>fit</code>: Fitted fractionation and blank parameters</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame with columns: name, P/D ratio, uncertainty, d/D ratio, uncertainty, ρ (for run) or array of [P/D, s[P/D], d/D, s[d/D], ρ] values (for single sample)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/averat.jl#L1-L15">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.blank!-Tuple{KJfit, KJmethod, Vector{Sample}}"><a class="docstring-binding" href="#KJ.blank!-Tuple{KJfit, KJmethod, Vector{Sample}}"><code>KJ.blank!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">blank!(fit::KJfit, method::KJmethod, run::Vector{Sample})</code></pre><p>Fit blank corrections for a run.</p><p>Extracts data from blank windows and fits polynomial background models for each channel.</p><p><strong>Arguments</strong></p><ul><li><code>fit</code>: Fit object to populate with blank parameters</li><li><code>method</code>: Method definition</li><li><code>run</code>: Vector of samples</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/blank.jl#L1-L13">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.blocks-Tuple{Vector{Sample}, Integer}"><a class="docstring-binding" href="#KJ.blocks-Tuple{Vector{Sample}, Integer}"><code>KJ.blocks</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">blocks(run::Vector{Sample}, blocksize::Integer; absolute_buffer=2.0, relative_buffer=0.1)</code></pre><p>Split a run into blocks of a given size and merge the samples within each block.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>: Vector of samples to divide into blocks</li><li><code>blocksize</code>: Number of samples per block</li><li><code>absolute_buffer</code>: Absolute time buffer for automatic window selection (default: 2.0 seconds)</li><li><code>relative_buffer</code>: Relative time buffer for automatic window selection (default: 0.1)</li></ul><p><strong>Returns</strong></p><ul><li>Vector of merged samples, one per block</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/blocks.jl#L1-L14">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.bwinData-Tuple{Sample}"><a class="docstring-binding" href="#KJ.bwinData-Tuple{Sample}"><code>KJ.bwinData</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">bwinData(samp::Sample; add_xy=false)</code></pre><p>Extract data from the blank window of a sample.</p><p><strong>Arguments</strong></p><ul><li><code>samp</code>: Sample to extract data from</li><li><code>add_xy</code>: If true, include x,y coordinates if available</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame containing the windowed data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/windows.jl#L118-L129">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.calculate_subset_stats-Tuple{AbstractMatrix, Vector{Int64}}"><a class="docstring-binding" href="#KJ.calculate_subset_stats-Tuple{AbstractMatrix, Vector{Int64}}"><code>KJ.calculate_subset_stats</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>calculate<em>subset</em>stats(X, indices)</p><p>Calculates the mean, covariance matrix, and its  determinant for a given subset of data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/MCD.jl#L5-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.concentration_step-Tuple{AbstractMatrix, Int64, Any, Any}"><a class="docstring-binding" href="#KJ.concentration_step-Tuple{AbstractMatrix, Int64, Any, Any}"><code>KJ.concentration_step</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>concentration<em>step(X, h, current</em>mu, current_Sigma)</p><p>The core C-Step. It finds the h observations closest to the current center (mu) based on the Mahalanobis distance derived from the current scatter matrix (Sigma).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/MCD.jl#L33-L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.concentrations-Tuple{Sample, Cmethod, Cfit}"><a class="docstring-binding" href="#KJ.concentrations-Tuple{Sample, Cmethod, Cfit}"><code>KJ.concentrations</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">concentrations(samp::Sample, method::Cmethod, fit::Cfit; internal=method.internal)
concentrations(run::Vector{Sample}, method::Cmethod, fit::Cfit)</code></pre><p>Calculate element concentrations from calibrated LA-ICP-MS data.</p><p>For single samples, returns time-resolved concentrations for each element. For runs, returns summary statistics (mean ± standard error) for each sample.</p><p><strong>Arguments</strong></p><ul><li><code>samp</code>/<code>run</code>: Sample or vector of samples</li><li><code>method</code>: Concentration method with element definitions and internal standard</li><li><code>fit</code>: Fitted sensitivity factors</li><li><code>internal</code>: Internal standard as (channel, concentration) tuple</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame with concentration values. For single samples, includes time-resolved data and optional x,y coordinates. For runs, includes sample names, means, and standard errors.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/concentrations.jl#L1-L20">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.detect_outliers!-Tuple{Vector{Sample}}"><a class="docstring-binding" href="#KJ.detect_outliers!-Tuple{Vector{Sample}}"><code>KJ.detect_outliers!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">detect_outliers!(run::Vector{Sample}; channels=getChannels(run), include_samples=false)
detect_outliers!(run::Vector{Sample}, method::KJmethod; include_samples=false)</code></pre><p>Detect and flag outliers in a run of samples (in-place modification).</p><p>Sets the <code>outlier</code> column in each sample&#39;s data frame to true for detected outliers.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>: Vector of samples to process</li><li><code>channels</code>/<code>method</code>: Channels to use for outlier detection, or method from which to extract channels</li><li><code>include_samples</code>: If true, also detect outliers in samples (not just standards)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/outliers.jl#L46-L58">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.detect_outliers-Tuple{AbstractVector}"><a class="docstring-binding" href="#KJ.detect_outliers-Tuple{AbstractVector}"><code>KJ.detect_outliers</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">detect_outliers(vec::AbstractVector; b=2)
detect_outliers(mat::Matrix; b=2)</code></pre><p>Detect outliers in time-series data using a moving median approach.</p><p>For vectors, uses interquartile range (IQR) criterion on deviations from moving median. For matrices, uses Mahalanobis distance and minimum covariance determinant (MCD).</p><p><strong>Arguments</strong></p><ul><li><code>vec</code>/<code>mat</code>: Time-series data as vector or matrix</li><li><code>b</code>: Bandwidth for moving median (default: 2)</li></ul><p><strong>Returns</strong></p><ul><li>Vector of indices where outliers are detected</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/outliers.jl#L1-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.df2cov-Tuple{DataFrames.AbstractDataFrame}"><a class="docstring-binding" href="#KJ.df2cov-Tuple{DataFrames.AbstractDataFrame}"><code>KJ.df2cov</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>function df2cov(df::AbstractDataFrame)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L177-L179">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.df2cov-Tuple{Matrix}"><a class="docstring-binding" href="#KJ.df2cov-Tuple{Matrix}"><code>KJ.df2cov</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>df2cov(mat::Matrix)</p><p>Estimate the covariance matrix of mat&#39;s columns from its differenced rows.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L167-L172">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.export2IsoplotR-Tuple{Vector{Sample}, Gmethod, Gfit}"><a class="docstring-binding" href="#KJ.export2IsoplotR-Tuple{Vector{Sample}, Gmethod, Gfit}"><code>KJ.export2IsoplotR</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">export2IsoplotR(run::Vector{Sample}, method::Gmethod, fit::Gfit; prefix=nothing, fname=&quot;KJ.json&quot;)
export2IsoplotR(ratios::AbstractDataFrame, method::Gmethod; fname=&quot;KJ.json&quot;)</code></pre><p>Export processed data to IsoplotR JSON format.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>: Vector of samples to export</li><li><code>ratios</code>: Pre-computed ratio data frame</li><li><code>method</code>: Geochronology method</li><li><code>fit</code>: Fitted parameters (for first method)</li><li><code>prefix</code>: Optional prefix to filter samples (default: export all)</li><li><code>fname</code>: Output filename (default: &quot;KJ.json&quot;)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/io.jl#L187-L200">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.fast_mcd-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T&lt;:Real"><a class="docstring-binding" href="#KJ.fast_mcd-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T&lt;:Real"><code>KJ.fast_mcd</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>fast<em>mcd(X::AbstractMatrix; h::Int=0, num</em>starts::Int=500, max<em>c</em>steps::Int=10)</p><p>Implements the FAST-MCD algorithm using randomized starts and concentration steps.</p><p><strong>Arguments</strong></p><ul><li><code>X</code>: The data matrix (observations as rows, features as columns).</li><li><code>h</code>: The size of the subset. Defaults to floor((n + p + 1) / 2) for max robustness.</li><li><code>num_starts</code>: Number of random initial subsets to check.</li><li><code>max_c_steps</code>: Maximum number of C-steps per start before declaring convergence.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/MCD.jl#L72-L82">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.fitBlanks-Tuple{Vector{Sample}}"><a class="docstring-binding" href="#KJ.fitBlanks-Tuple{Vector{Sample}}"><code>KJ.fitBlanks</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">fitBlanks(run::Vector{Sample}; nblank=2)</code></pre><p>Fit polynomial blank models to blank window data.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>: Vector of samples</li><li><code>nblank</code>: Order of polynomial (default: 2 for quadratic)</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame of polynomial coefficients for each channel</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/blank.jl#L22-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.fit_bias-Tuple{Vector{Sample}, Gmethod, DataFrames.AbstractDataFrame}"><a class="docstring-binding" href="#KJ.fit_bias-Tuple{Vector{Sample}, Gmethod, DataFrames.AbstractDataFrame}"><code>KJ.fit_bias</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">fit_bias(run::Vector{Sample}, method::Gmethod, blank::AbstractDataFrame)</code></pre><p>Fit mass bias corrections for isotope ratios.</p><p>Identifies and corrects for systematic bias in isotope ratio measurements using reference materials with known ratios.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>: Vector of samples including reference materials</li><li><code>method</code>: Geochronology method definition</li><li><code>blank</code>: Fitted blank corrections</li></ul><p><strong>Returns</strong></p><ul><li>Dictionary mapping elements to Bias objects containing correction parameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/bias.jl#L1-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.fractionation!-Tuple{Cfit, Cmethod, Vector{Sample}}"><a class="docstring-binding" href="#KJ.fractionation!-Tuple{Cfit, Cmethod, Vector{Sample}}"><code>KJ.fractionation!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> Cs  sum(S_i X_i)</code></pre><p>[f = – –––––––]      C    sum(S_i^2)</p><p>with C, Cs = reference concentrations of the elements and internal standard      X<em>i, S</em>i = blank-corrected measurement for elements and internal standard</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/fractionation.jl#L84-L91">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.fractionation!-Tuple{Gfit, Gmethod, Vector{Sample}}"><a class="docstring-binding" href="#KJ.fractionation!-Tuple{Gfit, Gmethod, Vector{Sample}}"><code>KJ.fractionation!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">fractionation!(fit::Gfit, method::Gmethod, run::Vector{Sample}; verbose=false)
fractionation!(fit::Cfit, method::Cmethod, run::Vector{Sample}; kwargs...)</code></pre><p>Fit drift and downhole fractionation corrections.</p><p>For geochronology methods (Gmethod), fits polynomial time-dependent drift and downhole corrections using reference materials. For concentration methods (Cmethod), fits sensitivity factors using internal standards.</p><p><strong>Arguments</strong></p><ul><li><code>fit</code>: Fit object to populate with fractionation parameters</li><li><code>method</code>: Method definition</li><li><code>run</code>: Vector of samples</li><li><code>verbose</code>: Print detailed optimization information (default: false)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/fractionation.jl#L1-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getAnchor-Tuple{AbstractString, AbstractString}"><a class="docstring-binding" href="#KJ.getAnchor-Tuple{AbstractString, AbstractString}"><code>KJ.getAnchor</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">getAnchor(methodname::AbstractString, refmat::AbstractString)
getAnchor(standard::AbstractRefmat; methodname::AbstractString)</code></pre><p>Get the anchor coordinates for a reference material.</p><p>Anchor points represent the known composition of reference materials in isotope ratio space, used for fractionation correction.</p><p><strong>Arguments</strong></p><ul><li><code>methodname</code>: Name of geochronology method (e.g., &quot;U-Pb&quot;, &quot;Rb-Sr&quot;)</li><li><code>refmat</code>/<code>standard</code>: Reference material name or object</li></ul><p><strong>Returns</strong></p><ul><li>Anchor object (IsochronAnchor, PointAnchor, or BiasAnchor)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/anchors.jl#L1-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getChannels-Tuple{Vector{Sample}}"><a class="docstring-binding" href="#KJ.getChannels-Tuple{Vector{Sample}}"><code>KJ.getChannels</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">getChannels(run::Vector{Sample})
getChannels(samp::Sample)
getChannels(interference::Interference)
getChannels(method::Gmethod)
getChannels(method::Cmethod)</code></pre><p>Get the names of all channels from samples, methods, or interferences.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L35-L43">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getGroups-Tuple{Vector{Sample}}"><a class="docstring-binding" href="#KJ.getGroups-Tuple{Vector{Sample}}"><code>KJ.getGroups</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">getGroups(run::Vector{Sample})</code></pre><p>Get a vector of group labels from a run.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L81-L85">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getIndicesInGroup-Tuple{Vector{Sample}, AbstractString}"><a class="docstring-binding" href="#KJ.getIndicesInGroup-Tuple{Vector{Sample}, AbstractString}"><code>KJ.getIndicesInGroup</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">getIndicesInGroup(run::Vector{Sample}, group::AbstractString)</code></pre><p>Find the indices of all samples in a run that belong to a specific group.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L91-L95">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getInternal-Tuple{AbstractString, AbstractString}"><a class="docstring-binding" href="#KJ.getInternal-Tuple{AbstractString, AbstractString}"><code>KJ.getInternal</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>getInternal(mineral::AbstractString,             channel::AbstractString)</p><p>Get a tuple with the channel and its reference concentration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L232-L237">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getKJctrl-Tuple{}"><a class="docstring-binding" href="#KJ.getKJctrl-Tuple{}"><code>KJ.getKJctrl</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">getKJctrl()</code></pre><p>Access the control parameters of a TUI session.</p><p><strong>Returns</strong></p><ul><li>Dictionary containing TUI control parameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L2-L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getP-Tuple{KJ.IsochronAnchor, AbstractVector, AbstractVector}"><a class="docstring-binding" href="#KJ.getP-Tuple{KJ.IsochronAnchor, AbstractVector, AbstractVector}"><code>KJ.getP</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">getP(a::IsochronAnchor, ft::AbstractVector, hT::AbstractVector; cruncher...)</code></pre><p>Calculate the parent isotope abundances for an isochron anchor.</p><p>This is a low-level function used internally for geochronological calculations.</p><p><strong>Arguments</strong></p><ul><li><code>a</code>: Isochron anchor point</li><li><code>ft</code>: Time-dependent fractionation factor</li><li><code>hT</code>: Downhole fractionation factor</li><li><code>cruncher...</code>: Named tuple containing measured data and covariances</li></ul><p><strong>Returns</strong></p><ul><li>Vector of parent isotope abundances</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/crunch.jl#L1-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getPDd-Tuple{AbstractString}"><a class="docstring-binding" href="#KJ.getPDd-Tuple{AbstractString}"><code>KJ.getPDd</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>getPDd(method::AbstractString)</p><p>Get the names of the parent, daughter and sister channel</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L221-L225">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.getSignals-Tuple{Sample}"><a class="docstring-binding" href="#KJ.getSignals-Tuple{Sample}"><code>KJ.getSignals</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>getSignals(samp::Sample)</p><p>Returns a dataframe with signals (no time, coordinates or outliers)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L211-L215">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.geti0-Tuple{DataFrames.AbstractDataFrame}"><a class="docstring-binding" href="#KJ.geti0-Tuple{DataFrames.AbstractDataFrame}"><code>KJ.geti0</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>geti0(signals::AbstractDataFrame)</p><p>Get the index of &#39;time zero&#39;, i.e. the onset of laser ablation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L144-L148">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.i2t-Tuple{Sample, Integer}"><a class="docstring-binding" href="#KJ.i2t-Tuple{Sample, Integer}"><code>KJ.i2t</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>i2t(samp::Sample,i::Integer)</p><p>Returns the time at index t</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L209-L213">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.interference_correction-Tuple{DataFrames.AbstractDataFrame, AbstractDict}"><a class="docstring-binding" href="#KJ.interference_correction-Tuple{DataFrames.AbstractDataFrame, AbstractDict}"><code>KJ.interference_correction</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">interference_correction(dat::AbstractDataFrame, interferences::AbstractDict; bias=Dict(), blank=DataFrame())
interference_correction(dat::AbstractDataFrame, ion::AbstractString, interference::Interference; bias=Dict(), blank=DataFrame())
interference_correction(dat::AbstractDataFrame, proxy_channel::AbstractString, interference::REEInterference; bias=Dict(), blank=DataFrame())</code></pre><p>Apply interference corrections to measured data.</p><p><strong>Arguments</strong></p><ul><li><code>dat</code>: DataFrame containing measured data with a time column</li><li><code>interferences</code>: Dictionary of interferences to correct for, or a single ion/channel and interference</li><li><code>bias</code>: Optional dictionary of bias corrections</li><li><code>blank</code>: Optional DataFrame with blank corrections</li></ul><p><strong>Returns</strong></p><ul><li>Vector of interference-corrected values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/interference.jl#L1-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.internochron-Tuple{Vector{Sample}, Gmethod, Gfit}"><a class="docstring-binding" href="#KJ.internochron-Tuple{Vector{Sample}, Gmethod, Gfit}"><code>KJ.internochron</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">internochron(run::Vector{Sample}, method::Gmethod, fit::Gfit)
internochron(samp::Sample, method::Gmethod, fit::Gfit)</code></pre><p>Calculate internal isochron (&quot;internochron&quot;) coordinates for samples.</p><p>For geochronology methods, this fits an isochron through the time-resolved data of each sample, returning the intercept coordinates (x0, y0) along with their uncertainties and correlation.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>/<code>samp</code>: Vector of samples or single sample</li><li><code>method</code>: Geochronology method definition</li><li><code>fit</code>: Fitted fractionation and blank parameters</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame with columns: name, x0, s[x0], y0, s[y0], ρ (for run) or array of [x0, s[x0], y0, s[y0], ρ] values (for single sample)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/internochron.jl#L1-L19">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.internoplot-Tuple{Sample, Gmethod, Gfit}"><a class="docstring-binding" href="#KJ.internoplot-Tuple{Sample, Gmethod, Gfit}"><code>KJ.internoplot</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">internoplot(samp::Sample, method::Gmethod, fit::Gfit; legend=false, nsigma=2, title=..., titlefontsize=10, plot_options...)</code></pre><p>Create an isochron plot for internal isochron data from a single sample.</p><p><strong>Arguments</strong></p><ul><li><code>samp</code>: Sample to plot</li><li><code>method</code>: Geochronology method definition</li><li><code>fit</code>: Fitted fractionation and blank parameters</li><li><code>legend</code>: Show legend (default: false)</li><li><code>nsigma</code>: Number of standard deviations for error envelope (default: 2)</li><li><code>title</code>: Plot title</li><li><code>titlefontsize</code>: Font size for title (default: 10)</li><li><code>plot_options...</code>: Additional plotting options</li></ul><p><strong>Returns</strong></p><ul><li>Plots.jl plot object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/internoplot.jl#L1-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.iratio-Tuple{AbstractString, AbstractString}"><a class="docstring-binding" href="#KJ.iratio-Tuple{AbstractString, AbstractString}"><code>KJ.iratio</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">iratio(nuclide1::AbstractString, nuclide2::AbstractString)</code></pre><p>Get the isotope ratio between two nuclides.</p><p><strong>Arguments</strong></p><ul><li><code>nuclide1</code>: Name of the numerator nuclide (e.g., &quot;U238&quot;)</li><li><code>nuclide2</code>: Name of the denominator nuclide (e.g., &quot;U235&quot;)</li></ul><p><strong>Returns</strong></p><ul><li>The isotope ratio, or <code>nothing</code> if not found in the database</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L473-L484">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.load-Tuple{AbstractString}"><a class="docstring-binding" href="#KJ.load-Tuple{AbstractString}"><code>KJ.load</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">load(dname::AbstractString; format=&quot;Agilent&quot;, head2name=true, nblocks=1, absolute_buffer=2.0, relative_buffer=0.1)
load(dfile::AbstractString, tfile::AbstractString; format=&quot;Agilent&quot;)</code></pre><p>Load LA-ICP-MS data from files.</p><p>The first method loads all files from a directory, sorts them by acquisition time, and optionally merges them into blocks. The second method loads a single data file with associated timestamps.</p><p><strong>Arguments</strong></p><ul><li><code>dname</code>/<code>dfile</code>: Directory containing data files, or path to a single data file</li><li><code>tfile</code>: Path to timestamp file (for second method)</li><li><code>format</code>: File format - &quot;Agilent&quot;, &quot;ThermoFisher&quot;, or &quot;FIN2&quot; (default: &quot;Agilent&quot;)</li><li><code>head2name</code>: Use file header for sample name (default: true)</li><li><code>nblocks</code>: Number of blocks to merge samples into (default: 1, no merging)</li><li><code>absolute_buffer</code>: Absolute time buffer for automatic window selection (default: 2.0 seconds)</li><li><code>relative_buffer</code>: Relative time buffer for automatic window selection (default: 0.1)</li></ul><p><strong>Returns</strong></p><ul><li>Vector of Sample objects</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/io.jl#L1-L22">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.moving_median_indices-Tuple{Int64}"><a class="docstring-binding" href="#KJ.moving_median_indices-Tuple{Int64}"><code>KJ.moving_median_indices</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">moving_median_indices(n::Int; b=2)</code></pre><p>Generate index matrix for moving median calculation.</p><p><strong>Arguments</strong></p><ul><li><code>n</code>: Length of the time series</li><li><code>b</code>: Bandwidth (default: 2)</li></ul><p><strong>Returns</strong></p><ul><li>Matrix of indices where each row contains the indices for computing the moving median at that position</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/outliers.jl#L98-L109">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.plot-Tuple{Sample, KJmethod}"><a class="docstring-binding" href="#KJ.plot-Tuple{Sample, KJmethod}"><code>KJ.plot</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">plot(samp::Sample, method::KJmethod; channels=getChannels(method), fit=nothing, num=&quot;&quot;, den=&quot;&quot;, transformation=&quot;&quot;, ...)
plot(samp::Sample; channels=getChannels(samp), num=&quot;&quot;, den=&quot;&quot;, transformation=&quot;&quot;, offset=..., ...)</code></pre><p>Plot time-resolved LA-ICP-MS data for a sample.</p><p>Displays signal intensities vs time with blank and signal windows marked. Optionally overlays fitted corrections if a fit object is provided.</p><p><strong>Arguments</strong></p><ul><li><code>samp</code>: Sample to plot</li><li><code>method</code>: Method definition (optional, for determining channels and fit)</li><li><code>channels</code>: Channels to display</li><li><code>fit</code>: Fitted corrections to overlay (optional)</li><li><code>num</code>, <code>den</code>: Numerator/denominator for ratio plots (default: plot raw signals)</li><li><code>transformation</code>: Apply transformation (&quot;log&quot;, &quot;sqrt&quot;, or &quot;&quot;)</li><li><code>xlim</code>, <code>ylim</code>: Plot limits</li><li><code>title</code>: Plot title</li><li><code>legend</code>: Legend position</li><li><code>cpalette</code>: Color palette</li><li><code>ms</code>, <code>ma</code>: Marker size and alpha</li><li>Additional plotting options</li></ul><p><strong>Returns</strong></p><ul><li>Plots.jl plot object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/plots.jl#L1-L26">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.plotFitted!-Tuple{Any, Sample, KJmethod, KJfit}"><a class="docstring-binding" href="#KJ.plotFitted!-Tuple{Any, Sample, KJmethod, KJfit}"><code>KJ.plotFitted!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">plotFitted!(p, samp::Sample, method::KJmethod, fit::KJfit; channels=..., num=&quot;&quot;, den=&quot;&quot;, transformation=&quot;&quot;, offset=0.0, linecolor=:black, linestyle=:solid)</code></pre><p>Overlay fitted signal predictions on an existing plot.</p><p><strong>Arguments</strong></p><ul><li><code>p</code>: Existing plot to overlay on</li><li><code>samp</code>: Sample being plotted</li><li><code>method</code>: Method definition</li><li><code>fit</code>: Fit object with correction parameters</li><li>Additional arguments control what is plotted and how it appears</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/plots.jl#L185-L196">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.plotFittedBlank!-Tuple{Any, Sample, KJmethod, KJfit}"><a class="docstring-binding" href="#KJ.plotFittedBlank!-Tuple{Any, Sample, KJmethod, KJfit}"><code>KJ.plotFittedBlank!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">plotFittedBlank!(p, samp::Sample, method::KJmethod, fit::KJfit; channels=..., num=&quot;&quot;, den=&quot;&quot;, transformation=&quot;&quot;, offset=0.0, linecolor=:black, linestyle=:solid)</code></pre><p>Overlay fitted blank predictions on an existing plot.</p><p><strong>Arguments</strong></p><ul><li><code>p</code>: Existing plot to overlay on</li><li><code>samp</code>: Sample being plotted</li><li><code>method</code>: Method definition</li><li><code>fit</code>: Fit object with blank parameters</li><li>Additional arguments control what is plotted and how it appears</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/plots.jl#L239-L250">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.plotMap-Tuple{DataFrames.AbstractDataFrame, AbstractString}"><a class="docstring-binding" href="#KJ.plotMap-Tuple{DataFrames.AbstractDataFrame, AbstractString}"><code>KJ.plotMap</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">plotMap(df::AbstractDataFrame, column::AbstractString; clims=(), markersize=2, markershape=:square, colorbar_scale=:log10, aspect_ratio=:equal, color=:viridis, ignore_negative=false)</code></pre><p>Create a spatial map visualization of a data column.</p><p>Requires that the DataFrame contains x and y coordinate columns.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: DataFrame containing data with x, y coordinates</li><li><code>column</code>: Column name to visualize</li><li><code>clims</code>: Color scale limits (optional)</li><li><code>markersize</code>: Size of map points (default: 2)</li><li><code>markershape</code>: Shape of markers (default: :square)</li><li><code>colorbar_scale</code>: Scale for colorbar, typically :log10 or :identity (default: :log10)</li><li><code>aspect_ratio</code>: Plot aspect ratio (default: :equal)</li><li><code>color</code>: Color palette (default: :viridis)</li><li><code>ignore_negative</code>: Exclude negative values from plot (default: false)</li></ul><p><strong>Returns</strong></p><ul><li>Plots.jl plot object, or nothing if x,y coordinates are missing</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/plots.jl#L270-L290">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.polyFac-Tuple{AbstractVector, AbstractVector}"><a class="docstring-binding" href="#KJ.polyFac-Tuple{AbstractVector, AbstractVector}"><code>KJ.polyFac</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">polyFac(p::AbstractVector, t::AbstractVector)</code></pre><p>Evaluate exponential of polynomial with parameters p at times t. Returns exp(p[1] + p[2]<em>t + p[3]</em>t^2 + ...).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L77-L82">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.polyVal-Tuple{AbstractVector, AbstractVector}"><a class="docstring-binding" href="#KJ.polyVal-Tuple{AbstractVector, AbstractVector}"><code>KJ.polyVal</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>polyVal(p::AbstractVector,t::AbstractVector)</p><p>Evaluates polynomial function with parameters p at times t.</p><p><strong>Arguments</strong></p><ul><li><code>p</code>: Vector of polynomial coefficients [p0, p1, p2, ...] representing p0 + p1<em>t + p2</em>t^2 + ...</li><li><code>t</code>: Vector of time values at which to evaluate the polynomial</li></ul><p><strong>Returns</strong></p><ul><li>Vector of polynomial values at each time point</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L31-L42">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.polyVal-Tuple{DataFrames.AbstractDataFrame, AbstractVector}"><a class="docstring-binding" href="#KJ.polyVal-Tuple{DataFrames.AbstractDataFrame, AbstractVector}"><code>KJ.polyVal</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>polyVal(p::AbstractDataFrame,t::AbstractVector)</p><p>Evaluates polynomial functions (one per column) at times t.</p><p><strong>Arguments</strong></p><ul><li><code>p</code>: DataFrame where each column contains polynomial coefficients</li><li><code>t</code>: Vector of time values at which to evaluate polynomials</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame with polynomial values, one column per input column</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L49-L60">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.predict-Tuple{Sample, Gmethod, Gfit}"><a class="docstring-binding" href="#KJ.predict-Tuple{Sample, Gmethod, Gfit}"><code>KJ.predict</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">predict(samp::Sample, method::Union{Gmethod,Cmethod}, fit::Union{Gfit,Cfit}; generic_names=true)
predict(samp::Sample, blank::AbstractDataFrame)</code></pre><p>Predict signal intensities for a sample given fitted parameters.</p><p>Calculates expected signal values based on fractionation model, anchor points, and bias corrections. Used for model checking and plotting fitted curves.</p><p><strong>Arguments</strong></p><ul><li><code>samp</code>: Sample to predict for</li><li><code>method</code>: Method definition</li><li><code>fit</code>: Fitted parameters</li><li><code>blank</code>: Blank fit (for blank prediction)</li><li><code>generic_names</code>: Use generic column names (P, D, d) vs specific isotopes (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame with predicted signals</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/predict.jl#L1-L19">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.prefix2subset-Tuple{DataFrames.AbstractDataFrame, AbstractString}"><a class="docstring-binding" href="#KJ.prefix2subset-Tuple{DataFrames.AbstractDataFrame, AbstractString}"><code>KJ.prefix2subset</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>prefix2subset(ratios::AbstractDataFrame,prefix::AbstractString)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L255-L257">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.prefix2subset-Tuple{Vector{Sample}, AbstractString}"><a class="docstring-binding" href="#KJ.prefix2subset-Tuple{Vector{Sample}, AbstractString}"><code>KJ.prefix2subset</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>prefix2subset(run::Vector{Sample},prefix::AbstractString)</p><p>Subset selected samples from run.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L245-L249">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.prep_plot-Tuple{Sample, AbstractVector}"><a class="docstring-binding" href="#KJ.prep_plot-Tuple{Sample, AbstractVector}"><code>KJ.prep_plot</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">prep_plot(samp::Sample, channels; offset=0.0, num=&quot;&quot;, den=&quot;&quot;, transformation=&quot;&quot;)</code></pre><p>Prepare data for plotting by extracting signals and applying transformations.</p><p><strong>Arguments</strong></p><ul><li><code>samp</code>: Sample to extract data from</li><li><code>channels</code>: Channels to include</li><li><code>offset</code>: Offset to add before transformation</li><li><code>num</code>, <code>den</code>: For ratio plots</li><li><code>transformation</code>: Transformation to apply</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (x, y, xlab, ylab) where x is time, y is DataFrame of processed signals</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/plots.jl#L147-L161">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.process!-Tuple{Vector{Sample}, KJmethod}"><a class="docstring-binding" href="#KJ.process!-Tuple{Vector{Sample}, KJmethod}"><code>KJ.process!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">process!(run::Vector{Sample}, method::KJmethod; reject_outliers=true, verbose=false)</code></pre><p>Process a complete run of LA-ICP-MS data.</p><p>This function performs the full data reduction workflow:</p><ol><li>Assign group labels to samples based on the method</li><li>Detect and flag outliers (if reject_outliers=true)</li><li>Initialize fit object</li><li>Fit blank corrections</li><li>Fit bias corrections (for Gmethod)</li><li>Fit drift and downhole fractionation corrections</li></ol><p><strong>Arguments</strong></p><ul><li><code>run</code>: Vector of samples to process</li><li><code>method</code>: Geochronology or concentration method definition</li><li><code>reject_outliers</code>: Whether to automatically detect and flag outliers (default: true)</li><li><code>verbose</code>: Print detailed diagnostic information (default: false)</li></ul><p><strong>Returns</strong></p><ul><li>Fitted KJfit object containing all correction parameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/process.jl#L1-L22">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.rle-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T"><a class="docstring-binding" href="#KJ.rle-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T"><code>KJ.rle</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>rle(v)</p><p>Return the run-length encoding of a vector as a tuple.</p><p>Function lifted from StatsBase.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L308-L314">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.setBwin!-Tuple{Vector{Sample}, AbstractVector}"><a class="docstring-binding" href="#KJ.setBwin!-Tuple{Vector{Sample}, AbstractVector}"><code>KJ.setBwin!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">setBwin!(run::Vector{Sample}, bwin::AbstractVector; seconds=false)
setBwin!(samp::Sample, bwin::AbstractVector; seconds=false)
setBwin!(run::Vector{Sample})
setBwin!(samp::Sample)</code></pre><p>Set the blank window (bwin) for one or more samples.</p><p>If <code>bwin</code> is provided, it is directly set (as indices or time in seconds if <code>seconds=true</code>). If no <code>bwin</code> is provided, an automatic blank window is calculated.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>/<code>samp</code>: Vector of samples or single sample</li><li><code>bwin</code>: Window specification (optional)</li><li><code>seconds</code>: If true, interpret window as time in seconds; otherwise as indices</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/windows.jl#L1-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.setGroup!-Tuple{Vector{Sample}, KJmethod}"><a class="docstring-binding" href="#KJ.setGroup!-Tuple{Vector{Sample}, KJmethod}"><code>KJ.setGroup!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">setGroup!(run::Vector{Sample}, method::KJmethod)
setGroup!(run::Vector{Sample}, selection, group::AbstractString)
setGroup!(run::Vector{Sample}, prefixes::Vector{String})</code></pre><p>Set the group labels for samples in a run, either from a method definition, by selecting specific sample indices, or by matching prefixes in sample names.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L113-L120">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.setKJctrl!-Tuple{AbstractDict}"><a class="docstring-binding" href="#KJ.setKJctrl!-Tuple{AbstractDict}"><code>KJ.setKJctrl!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">setKJctrl!(ctrl::AbstractDict)</code></pre><p>Set the control parameters of a TUI session.</p><p><strong>Arguments</strong></p><ul><li><code>ctrl</code>: Dictionary of control parameters to set</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L15-L22">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.setSwin!-Tuple{Vector{Sample}, AbstractVector}"><a class="docstring-binding" href="#KJ.setSwin!-Tuple{Vector{Sample}, AbstractVector}"><code>KJ.setSwin!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">setSwin!(run::Vector{Sample}, swin::AbstractVector; seconds=false)
setSwin!(samp::Sample, swin::AbstractVector; seconds=false)
setSwin!(run::Vector{Sample})
setSwin!(samp::Sample)</code></pre><p>Set the signal window (swin) for one or more samples.</p><p>If <code>swin</code> is provided, it is directly set (as indices or time in seconds if <code>seconds=true</code>). If no <code>swin</code> is provided, an automatic signal window is calculated.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>/<code>samp</code>: Vector of samples or single sample</li><li><code>swin</code>: Window specification (optional)</li><li><code>seconds</code>: If true, interpret window as time in seconds; otherwise as indices</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/windows.jl#L43-L58">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.sett0!-Tuple{Sample, Number}"><a class="docstring-binding" href="#KJ.sett0!-Tuple{Sample, Number}"><code>KJ.sett0!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>sett0!(samp::Sample,        t0::Number)</p><p>Manually set time zero for a single sample</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L194-L199">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.sett0!-Tuple{Sample}"><a class="docstring-binding" href="#KJ.sett0!-Tuple{Sample}"><code>KJ.sett0!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>sett0!(samp::Sample)</p><p>Automatically set time zero for a single sample.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L183-L187">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.sett0!-Tuple{Vector{Sample}, Number}"><a class="docstring-binding" href="#KJ.sett0!-Tuple{Vector{Sample}, Number}"><code>KJ.sett0!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>sett0!(run::Vector{Sample},        t0::Number)</p><p>Manually set time zero for an entire run.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L170-L175">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.sett0!-Tuple{Vector{Sample}}"><a class="docstring-binding" href="#KJ.sett0!-Tuple{Vector{Sample}}"><code>KJ.sett0!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>sett0!(run::Vector{Sample})</p><p>Automatically set time zero, i.e. the onset of laser ablation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/accessors.jl#L159-L163">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.shift_windows!"><a class="docstring-binding" href="#KJ.shift_windows!"><code>KJ.shift_windows!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">shift_windows!(run::Vector{Sample}, shift::Number=0.0)</code></pre><p>Shift both blank and signal windows for all samples in a run by a given time offset.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>: Vector of samples</li><li><code>shift</code>: Time shift in seconds (default: 0.0)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/windows.jl#L85-L93">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.summarise-Tuple{Gfit}"><a class="docstring-binding" href="#KJ.summarise-Tuple{Gfit}"><code>KJ.summarise</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">summarise(fit::Gfit)</code></pre><p>Print a summary of fitted parameters from a Gfit object.</p><p>Displays drift corrections, down-hole fractionation factors, elemental drift corrections, the covariance matrix, and bias parameters for each element.</p><p><strong>Arguments</strong></p><ul><li><code>fit</code>: A Gfit object containing fitted calibration parameters</li></ul><p><strong>Returns</strong></p><ul><li>Nothing. Output is printed to stdout.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/io.jl#L300-L313">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.summarise-Tuple{Vector{Sample}}"><a class="docstring-binding" href="#KJ.summarise-Tuple{Vector{Sample}}"><code>KJ.summarise</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">summarise(run::Vector{Sample}; verbose=true, n=length(run))</code></pre><p>Create a summary DataFrame of samples with their names, acquisition dates, and group assignments.</p><p><strong>Arguments</strong></p><ul><li><code>run</code>: Vector of Sample objects to summarize</li><li><code>verbose</code>: If true, print the first n rows of the summary (default: true)</li><li><code>n</code>: Number of rows to display when verbose is true (default: length(run))</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame with columns: name, date, and group for each sample</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/io.jl#L262-L274">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.summarize-Tuple{Gfit}"><a class="docstring-binding" href="#KJ.summarize-Tuple{Gfit}"><code>KJ.summarize</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">summarize(fit::Gfit)</code></pre><p>American spelling alias for <code>summarise</code>. See <a href="#KJ.summarise-Tuple{Gfit}"><code>summarise</code></a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/io.jl#L325-L329">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.summarize-Tuple{Vector{Sample}}"><a class="docstring-binding" href="#KJ.summarize-Tuple{Vector{Sample}}"><code>KJ.summarize</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">summarize(run::Vector{Sample}; verbose=true, n=length(run))</code></pre><p>American spelling alias for <code>summarise</code>. See <a href="#KJ.summarise-Tuple{Gfit}"><code>summarise</code></a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/io.jl#L290-L294">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.swinData-Tuple{Sample}"><a class="docstring-binding" href="#KJ.swinData-Tuple{Sample}"><code>KJ.swinData</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">swinData(samp::Sample; add_xy=false)</code></pre><p>Extract data from the signal window of a sample.</p><p>The returned data includes a <code>T</code> column with relative time in minutes from t0. If x,y coordinates are available and <code>add_xy=true</code>, they are also included.</p><p><strong>Arguments</strong></p><ul><li><code>samp</code>: Sample to extract data from</li><li><code>add_xy</code>: If true, include x,y coordinates if available</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame containing the windowed data with time column <code>T</code> in minutes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/windows.jl#L139-L153">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.t2i-Tuple{Sample, Number}"><a class="docstring-binding" href="#KJ.t2i-Tuple{Sample, Number}"><code>KJ.t2i</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>t2i(samp::Sample,t::Number)</p><p>Returns the index of time t in sample samp.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L197-L201">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.time2window-Tuple{Sample, AbstractVector}"><a class="docstring-binding" href="#KJ.time2window-Tuple{Sample, AbstractVector}"><code>KJ.time2window</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>time2window(samp::Sample,twin::AbstractVector)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L233-L235">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.time2window-Tuple{Sample, Number, Number}"><a class="docstring-binding" href="#KJ.time2window-Tuple{Sample, Number, Number}"><code>KJ.time2window</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>time2window(samp::Sample,start::Number,finish::Number)</p><p>Returns a tuple or a vector of tuples with the indices corresponding to the start and finish times.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L221-L226">source</a></section></details></article><article><details class="docstring" open="true"><summary id="KJ.var_timeseries-Tuple{AbstractVector}"><a class="docstring-binding" href="#KJ.var_timeseries-Tuple{AbstractVector}"><code>KJ.var_timeseries</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>var_timeseries(cps::AbstractVector)</p><p>Estimate the variance of the differenced vector cps. Returns a vector of replicate values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/pvermees/KJ.jl/blob/24d95ab828ba1dc4e1a7d509c41a8fb5c34fcb67/src/toolbox.jl#L185-L190">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tui/">« TUI</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 20 February 2026 14:48">Friday 20 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
